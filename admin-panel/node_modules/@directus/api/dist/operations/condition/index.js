import { defineOperationApi } from '@directus/extensions';
import { validatePayload } from '@directus/utils';
import { FailedValidationError, joiValidationErrorItemToErrorExtensions } from '@directus/validation';
export default defineOperationApi({
    id: 'condition',
    handler: ({ filter }, { data }) => {
        const errors = validatePayload(filter, data, { requireAll: true });
        if (errors.length > 0) {
            // sanitize and format errors
            const validationErrors = errors
                .map((error) => error.details.map((details) => new FailedValidationError(joiValidationErrorItemToErrorExtensions(details))))
                .flat();
            throw validationErrors;
        }
        else {
            return null;
        }
    },
});
